<%inherit file="layout.html"/>
<div class="offset2 span12">
<h1>Parameters</h1>

<%param_array='\",\"'.join(params)%>

%for key in params:
<%
val=values[params.index(key)]
%>
<div class="row-fluid">
<form id="${key}-form" name="${key}" class="form-horizontal" action="" method="post"> 
<label for="${key}-text">${key}</label>
<input type="text" id="${key}-text" placeholder="${val}" value="${val}" name="${key}" />
<input type="submit" value="Get" class="get btn" />
<input type="submit" value="Set" class="set btn btn-primary" />
</form> 
</div>
%endfor

</div>
<script src="http://code.jquery.com/jquery.js"></script>
<script src="/media/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript">
var getParam = function(param) {
	$.get(
			'/getparam/' + param,
			function(data) {
			$('#' + param + '-text').val(data['value']);
			}
	     );       
};

$(".set").on('click', function(e) {
		e.preventDefault();

		var me = $(this),
		form = me.closest('form'),
		textfield = $('input[type=text]', form);

		$.post(
			'/setparam/' + textfield.attr('name'), 
			{
data: textfield.val()
}, 
function(data) {
textfield.val(data['value']);
setTimeout(function() {
	getParam(textfield.attr('name'));
	}, 2000);	
});
		});

$(".get").on('click', function(e) {
		e.preventDefault();

		var me = $(this),
		form = me.closest('form'),
		textfield = $('input[type=text]', form);

		getParam(textfield.attr('name'));

		});

var parameters = ["${param_array}"]
for (i=0;i<parameters.length;i++) {
	getParam(parameters[i]); 
}

</script>
